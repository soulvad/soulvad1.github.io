{"ast":null,"code":"var _jsxFileName = \"D:\\\\NULP\\\\SEM4\\\\labs\\\\\\u0412\\u0435\\u0431\\\\soulvad1.github.io\\\\src\\\\components\\\\ToursPage.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport styled from 'styled-components';\nimport TourCard from './TourCard';\nimport { useAuth } from '../context/AuthContext';\nimport { tourService } from '../services/tourService';\nimport Map from './Map';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ToursContainer = styled.div`\n  padding: 2rem 0;\n`;\n_c = ToursContainer;\nconst Title = styled.h2`\n  color: #37475a;\n  margin-bottom: 2rem;\n  text-align: center;\n`;\n_c2 = Title;\nconst ToursGrid = styled.div`\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));\n  gap: 2rem;\n  padding: 0 1rem;\n`;\n_c3 = ToursGrid;\nconst LoadingMessage = styled.div`\n  text-align: center;\n  color: #666;\n  font-size: 1.2rem;\n  margin: 2rem 0;\n`;\n_c4 = LoadingMessage;\nconst ErrorMessage = styled.div`\n  text-align: center;\n  color: #dc3545;\n  font-size: 1.2rem;\n  margin: 2rem 0;\n`;\n_c5 = ErrorMessage;\nconst SortButton = styled.button`\n  background-color: #4a90e2;\n  color: white;\n  border: none;\n  padding: 10px 20px;\n  border-radius: 4px;\n  cursor: pointer;\n  font-weight: 500;\n  margin-bottom: 20px;\n  margin-left: auto;\n  display: block;\n  transition: background-color 0.3s;\n  font-size: 1rem;\n\n  &:hover {\n    background-color: #357abd;\n  }\n`;\n_c6 = SortButton;\nconst ToursPage = () => {\n  _s();\n  const [tours, setTours] = useState([]);\n  const [bookings, setBookings] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState('');\n  const [sorted, setSorted] = useState(false);\n  const {\n    currentUser\n  } = useAuth();\n  const fetchData = async () => {\n    try {\n      const [toursList, userBookings] = await Promise.all([tourService.getAllTours(), currentUser ? tourService.getUserBookings(currentUser.uid) : []]);\n      setTours(toursList);\n      setBookings(userBookings.map(booking => booking.tourId));\n    } catch (err) {\n      setError('Помилка завантаження даних');\n      console.error('Error fetching data:', err);\n    } finally {\n      setLoading(false);\n    }\n  };\n  useEffect(() => {\n    fetchData();\n  }, [currentUser]);\n  const handleBook = async tourId => {\n    if (!currentUser) {\n      setError('Будь ласка, увійдіть в систему для бронювання');\n      return;\n    }\n    try {\n      if (bookings.includes(tourId)) {\n        // Якщо тур вже заброньований, скасовуємо бронювання\n        const userBookings = await tourService.getUserBookings(currentUser.uid);\n        const bookingToCancel = userBookings.find(booking => booking.tourId === tourId);\n        if (bookingToCancel) {\n          await tourService.cancelBooking(bookingToCancel.id);\n        }\n      } else {\n        // Якщо тур не заброньований, створюємо нове бронювання\n        await tourService.addBooking(tourId, currentUser.uid);\n      }\n      await fetchData();\n    } catch (err) {\n      setError('Помилка при бронюванні туру');\n    }\n  };\n  const handleSortByPrice = () => {\n    setTours(prev => {\n      const sortedTours = [...prev].sort((a, b) => a.price - b.price);\n      return sortedTours;\n    });\n    setSorted(true);\n  };\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(LoadingMessage, {\n      children: \"\\u0417\\u0430\\u0432\\u0430\\u043D\\u0442\\u0430\\u0436\\u0435\\u043D\\u043D\\u044F \\u0442\\u0443\\u0440\\u0456\\u0432...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 12\n    }, this);\n  }\n  if (error) {\n    return /*#__PURE__*/_jsxDEV(ErrorMessage, {\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 12\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(ToursContainer, {\n    children: [/*#__PURE__*/_jsxDEV(Title, {\n      children: \"\\u0414\\u043E\\u0441\\u0442\\u0443\\u043F\\u043D\\u0456 \\u0442\\u0443\\u0440\\u0438\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Map, {\n      tours: tours,\n      onBook: handleBook,\n      bookings: bookings\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(SortButton, {\n      onClick: handleSortByPrice,\n      children: \"\\u0421\\u043E\\u0440\\u0442\\u0443\\u0432\\u0430\\u0442\\u0438 \\u0437\\u0430 \\u0446\\u0456\\u043D\\u043E\\u044E\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(ToursGrid, {\n      children: tours.map(tour => /*#__PURE__*/_jsxDEV(TourCard, {\n        ...tour,\n        onBook: handleBook,\n        isBooking: bookings.includes(tour.id),\n        isBookedView: bookings.includes(tour.id)\n      }, tour.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 131,\n    columnNumber: 5\n  }, this);\n};\n_s(ToursPage, \"P/2b49+BbMpEL/UYHE0fPUN1x24=\", false, function () {\n  return [useAuth];\n});\n_c7 = ToursPage;\nexport default ToursPage;\nvar _c, _c2, _c3, _c4, _c5, _c6, _c7;\n$RefreshReg$(_c, \"ToursContainer\");\n$RefreshReg$(_c2, \"Title\");\n$RefreshReg$(_c3, \"ToursGrid\");\n$RefreshReg$(_c4, \"LoadingMessage\");\n$RefreshReg$(_c5, \"ErrorMessage\");\n$RefreshReg$(_c6, \"SortButton\");\n$RefreshReg$(_c7, \"ToursPage\");","map":{"version":3,"names":["React","useState","useEffect","styled","TourCard","useAuth","tourService","Map","jsxDEV","_jsxDEV","ToursContainer","div","_c","Title","h2","_c2","ToursGrid","_c3","LoadingMessage","_c4","ErrorMessage","_c5","SortButton","button","_c6","ToursPage","_s","tours","setTours","bookings","setBookings","loading","setLoading","error","setError","sorted","setSorted","currentUser","fetchData","toursList","userBookings","Promise","all","getAllTours","getUserBookings","uid","map","booking","tourId","err","console","handleBook","includes","bookingToCancel","find","cancelBooking","id","addBooking","handleSortByPrice","prev","sortedTours","sort","a","b","price","children","fileName","_jsxFileName","lineNumber","columnNumber","onBook","onClick","tour","isBooking","isBookedView","_c7","$RefreshReg$"],"sources":["D:/NULP/SEM4/labs/Веб/soulvad1.github.io/src/components/ToursPage.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport styled from 'styled-components';\r\nimport { collection, getDocs } from 'firebase/firestore';\r\nimport { db } from '../firebase/config';\r\nimport { Tour } from '../types';\r\nimport TourCard from './TourCard';\r\nimport { useAuth } from '../context/AuthContext';\r\nimport { tourService } from '../services/tourService';\r\nimport Map from './Map';\r\n\r\nconst ToursContainer = styled.div`\r\n  padding: 2rem 0;\r\n`;\r\n\r\nconst Title = styled.h2`\r\n  color: #37475a;\r\n  margin-bottom: 2rem;\r\n  text-align: center;\r\n`;\r\n\r\nconst ToursGrid = styled.div`\r\n  display: grid;\r\n  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));\r\n  gap: 2rem;\r\n  padding: 0 1rem;\r\n`;\r\n\r\nconst LoadingMessage = styled.div`\r\n  text-align: center;\r\n  color: #666;\r\n  font-size: 1.2rem;\r\n  margin: 2rem 0;\r\n`;\r\n\r\nconst ErrorMessage = styled.div`\r\n  text-align: center;\r\n  color: #dc3545;\r\n  font-size: 1.2rem;\r\n  margin: 2rem 0;\r\n`;\r\n\r\nconst SortButton = styled.button`\r\n  background-color: #4a90e2;\r\n  color: white;\r\n  border: none;\r\n  padding: 10px 20px;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n  font-weight: 500;\r\n  margin-bottom: 20px;\r\n  margin-left: auto;\r\n  display: block;\r\n  transition: background-color 0.3s;\r\n  font-size: 1rem;\r\n\r\n  &:hover {\r\n    background-color: #357abd;\r\n  }\r\n`;\r\n\r\nconst ToursPage: React.FC = () => {\r\n  const [tours, setTours] = useState<Tour[]>([]);\r\n  const [bookings, setBookings] = useState<string[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState('');\r\n  const [sorted, setSorted] = useState(false);\r\n  const { currentUser } = useAuth();\r\n\r\n  const fetchData = async () => {\r\n    try {\r\n      const [toursList, userBookings] = await Promise.all([\r\n        tourService.getAllTours(),\r\n        currentUser ? tourService.getUserBookings(currentUser.uid) : []\r\n      ]);\r\n      \r\n      setTours(toursList);\r\n      setBookings(userBookings.map(booking => booking.tourId));\r\n    } catch (err) {\r\n      setError('Помилка завантаження даних');\r\n      console.error('Error fetching data:', err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchData();\r\n  }, [currentUser]);\r\n\r\n  const handleBook = async (tourId: string) => {\r\n    if (!currentUser) {\r\n      setError('Будь ласка, увійдіть в систему для бронювання');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      if (bookings.includes(tourId)) {\r\n        // Якщо тур вже заброньований, скасовуємо бронювання\r\n        const userBookings = await tourService.getUserBookings(currentUser.uid);\r\n        const bookingToCancel = userBookings.find(booking => booking.tourId === tourId);\r\n        if (bookingToCancel) {\r\n          await tourService.cancelBooking(bookingToCancel.id);\r\n        }\r\n      } else {\r\n        // Якщо тур не заброньований, створюємо нове бронювання\r\n        await tourService.addBooking(tourId, currentUser.uid);\r\n      }\r\n      await fetchData();\r\n    } catch (err) {\r\n      setError('Помилка при бронюванні туру');\r\n    }\r\n  };\r\n\r\n  const handleSortByPrice = () => {\r\n    setTours(prev => {\r\n      const sortedTours = [...prev].sort((a, b) => a.price - b.price);\r\n      return sortedTours;\r\n    });\r\n    setSorted(true);\r\n  };\r\n\r\n  if (loading) {\r\n    return <LoadingMessage>Завантаження турів...</LoadingMessage>;\r\n  }\r\n\r\n  if (error) {\r\n    return <ErrorMessage>{error}</ErrorMessage>;\r\n  }\r\n\r\n  return (\r\n    <ToursContainer>\r\n      <Title>Доступні тури</Title>\r\n      <Map tours={tours} onBook={handleBook} bookings={bookings} />\r\n      <SortButton onClick={handleSortByPrice}>Сортувати за ціною</SortButton>\r\n      <ToursGrid>\r\n        {tours.map((tour) => (\r\n          <TourCard\r\n            key={tour.id}\r\n            {...tour}\r\n            onBook={handleBook}\r\n            isBooking={bookings.includes(tour.id)}\r\n            isBookedView={bookings.includes(tour.id)}\r\n          />\r\n        ))}\r\n      </ToursGrid>\r\n    </ToursContainer>\r\n  );\r\n};\r\n\r\nexport default ToursPage; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}